#!/bin/bash

# Function to allocate and deallocate memory
memoryUsageSimulation() {
    # Generate a random amount of memory to allocate between 1MB and 250MB
    memoryToAllocate=$(randomMemorySize)
    echo "Allocating $memoryToAllocate MB of memory..."

    # Allocate the specified amount of memory by creating an array and filling it with data
    local -a memoryHog
    for ((i = 0; i < memoryToAllocate; i++)); do
        memoryHog+=($(head -c 1M < /dev/urandom | base64))
    done

    # Deallocate memory by clearing the array
    unset memoryHog
    echo "Deallocated memory."
}

# Function to generate a random memory size between 1 and 250 MB
randomMemorySize() {
    echo $((RANDOM % 250 + 1))
}

# Function to generate a random delay between 5 and 15 seconds
randomDelay() {
    echo $((RANDOM % 11 + 5))
}

# Infinite loop
while true; do
    # Perform memory usage simulation
    memoryUsageSimulation

    # Generate a random delay and sleep for that duration
    delay=$(randomDelay)
    echo "Sleeping for $delay seconds..."
    sleep $delay
done
